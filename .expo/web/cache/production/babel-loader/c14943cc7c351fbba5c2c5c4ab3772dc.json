{"ast":null,"code":"'use strict';function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var Info=function Info(){this.any_blank_count=0;this.any_blank_ms=0;this.any_blank_speed_sum=0;this.mostly_blank_count=0;this.mostly_blank_ms=0;this.pixels_blank=0;this.pixels_sampled=0;this.pixels_scrolled=0;this.total_time_spent=0;this.sample_count=0;};var DEBUG=false;var _listeners=[];var _minSampleCount=10;var _sampleRate=DEBUG?1:null;var FillRateHelper=function(){FillRateHelper.addListener=function addListener(callback){if(_sampleRate===null){console.warn('Call `FillRateHelper.setSampleRate` before `addListener`.');}_listeners.push(callback);return{remove:function remove(){_listeners=_listeners.filter(function(listener){return callback!==listener;});}};};FillRateHelper.setSampleRate=function setSampleRate(sampleRate){_sampleRate=sampleRate;};FillRateHelper.setMinSampleCount=function setMinSampleCount(minSampleCount){_minSampleCount=minSampleCount;};function FillRateHelper(getFrameMetrics){this._anyBlankStartTime=null;this._enabled=false;this._info=new Info();this._mostlyBlankStartTime=null;this._samplesStartTime=null;this._getFrameMetrics=getFrameMetrics;this._enabled=(_sampleRate||0)>Math.random();this._resetData();}var _proto=FillRateHelper.prototype;_proto.activate=function activate(){if(this._enabled&&this._samplesStartTime==null){DEBUG&&console.debug('FillRateHelper: activate');this._samplesStartTime=global.performance.now();}};_proto.deactivateAndFlush=function deactivateAndFlush(){if(!this._enabled){return;}var start=this._samplesStartTime;if(start==null){DEBUG&&console.debug('FillRateHelper: bail on deactivate with no start time');return;}if(this._info.sample_count<_minSampleCount){this._resetData();return;}var total_time_spent=global.performance.now()-start;var info=_objectSpread(_objectSpread({},this._info),{},{total_time_spent:total_time_spent});if(DEBUG){var derived={avg_blankness:this._info.pixels_blank/this._info.pixels_sampled,avg_speed:this._info.pixels_scrolled/(total_time_spent/1000),avg_speed_when_any_blank:this._info.any_blank_speed_sum/this._info.any_blank_count,any_blank_per_min:this._info.any_blank_count/(total_time_spent/1000/60),any_blank_time_frac:this._info.any_blank_ms/total_time_spent,mostly_blank_per_min:this._info.mostly_blank_count/(total_time_spent/1000/60),mostly_blank_time_frac:this._info.mostly_blank_ms/total_time_spent};for(var key in derived){derived[key]=Math.round(1000*derived[key])/1000;}console.debug('FillRateHelper deactivateAndFlush: ',{derived:derived,info:info});}_listeners.forEach(function(listener){return listener(info);});this._resetData();};_proto.computeBlankness=function computeBlankness(props,state,scrollMetrics){if(!this._enabled||props.getItemCount(props.data)===0||this._samplesStartTime==null){return 0;}var dOffset=scrollMetrics.dOffset,offset=scrollMetrics.offset,velocity=scrollMetrics.velocity,visibleLength=scrollMetrics.visibleLength;this._info.sample_count++;this._info.pixels_sampled+=Math.round(visibleLength);this._info.pixels_scrolled+=Math.round(Math.abs(dOffset));var scrollSpeed=Math.round(Math.abs(velocity)*1000);var now=global.performance.now();if(this._anyBlankStartTime!=null){this._info.any_blank_ms+=now-this._anyBlankStartTime;}this._anyBlankStartTime=null;if(this._mostlyBlankStartTime!=null){this._info.mostly_blank_ms+=now-this._mostlyBlankStartTime;}this._mostlyBlankStartTime=null;var blankTop=0;var first=state.first;var firstFrame=this._getFrameMetrics(first);while(first<=state.last&&(!firstFrame||!firstFrame.inLayout)){firstFrame=this._getFrameMetrics(first);first++;}if(firstFrame&&first>0){blankTop=Math.min(visibleLength,Math.max(0,firstFrame.offset-offset));}var blankBottom=0;var last=state.last;var lastFrame=this._getFrameMetrics(last);while(last>=state.first&&(!lastFrame||!lastFrame.inLayout)){lastFrame=this._getFrameMetrics(last);last--;}if(lastFrame&&last<props.getItemCount(props.data)-1){var bottomEdge=lastFrame.offset+lastFrame.length;blankBottom=Math.min(visibleLength,Math.max(0,offset+visibleLength-bottomEdge));}var pixels_blank=Math.round(blankTop+blankBottom);var blankness=pixels_blank/visibleLength;if(blankness>0){this._anyBlankStartTime=now;this._info.any_blank_speed_sum+=scrollSpeed;this._info.any_blank_count++;this._info.pixels_blank+=pixels_blank;if(blankness>0.5){this._mostlyBlankStartTime=now;this._info.mostly_blank_count++;}}else if(scrollSpeed<0.01||Math.abs(dOffset)<1){this.deactivateAndFlush();}return blankness;};_proto.enabled=function enabled(){return this._enabled;};_proto._resetData=function _resetData(){this._anyBlankStartTime=null;this._info=new Info();this._mostlyBlankStartTime=null;this._samplesStartTime=null;};return FillRateHelper;}();export default FillRateHelper;","map":{"version":3,"sources":["/Users/mas/Documents/perso/expo-splashscreen-generator/node_modules/react-native-web/dist/vendor/react-native/FillRateHelper/index.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","Info","any_blank_count","any_blank_ms","any_blank_speed_sum","mostly_blank_count","mostly_blank_ms","pixels_blank","pixels_sampled","pixels_scrolled","total_time_spent","sample_count","DEBUG","_listeners","_minSampleCount","_sampleRate","FillRateHelper","addListener","callback","console","warn","remove","listener","setSampleRate","sampleRate","setMinSampleCount","minSampleCount","getFrameMetrics","_anyBlankStartTime","_enabled","_info","_mostlyBlankStartTime","_samplesStartTime","_getFrameMetrics","Math","random","_resetData","_proto","prototype","activate","debug","global","performance","now","deactivateAndFlush","start","info","derived","avg_blankness","avg_speed","avg_speed_when_any_blank","any_blank_per_min","any_blank_time_frac","mostly_blank_per_min","mostly_blank_time_frac","round","computeBlankness","props","state","scrollMetrics","getItemCount","data","dOffset","offset","velocity","visibleLength","abs","scrollSpeed","blankTop","first","firstFrame","last","inLayout","min","max","blankBottom","lastFrame","bottomEdge","blankness","enabled"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n */\n'use strict';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar Info = function Info() {\n  this.any_blank_count = 0;\n  this.any_blank_ms = 0;\n  this.any_blank_speed_sum = 0;\n  this.mostly_blank_count = 0;\n  this.mostly_blank_ms = 0;\n  this.pixels_blank = 0;\n  this.pixels_sampled = 0;\n  this.pixels_scrolled = 0;\n  this.total_time_spent = 0;\n  this.sample_count = 0;\n};\n\nvar DEBUG = false;\nvar _listeners = [];\nvar _minSampleCount = 10;\n\nvar _sampleRate = DEBUG ? 1 : null;\n/**\n * A helper class for detecting when the maximem fill rate of `VirtualizedList` is exceeded.\n * By default the sampling rate is set to zero and this will do nothing. If you want to collect\n * samples (e.g. to log them), make sure to call `FillRateHelper.setSampleRate(0.0-1.0)`.\n *\n * Listeners and sample rate are global for all `VirtualizedList`s - typical usage will combine with\n * `SceneTracker.getActiveScene` to determine the context of the events.\n */\n\n\nvar FillRateHelper = /*#__PURE__*/function () {\n  FillRateHelper.addListener = function addListener(callback) {\n    if (_sampleRate === null) {\n      console.warn('Call `FillRateHelper.setSampleRate` before `addListener`.');\n    }\n\n    _listeners.push(callback);\n\n    return {\n      remove: function remove() {\n        _listeners = _listeners.filter(function (listener) {\n          return callback !== listener;\n        });\n      }\n    };\n  };\n\n  FillRateHelper.setSampleRate = function setSampleRate(sampleRate) {\n    _sampleRate = sampleRate;\n  };\n\n  FillRateHelper.setMinSampleCount = function setMinSampleCount(minSampleCount) {\n    _minSampleCount = minSampleCount;\n  };\n\n  function FillRateHelper(getFrameMetrics) {\n    this._anyBlankStartTime = null;\n    this._enabled = false;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n    this._getFrameMetrics = getFrameMetrics;\n    this._enabled = (_sampleRate || 0) > Math.random();\n\n    this._resetData();\n  }\n\n  var _proto = FillRateHelper.prototype;\n\n  _proto.activate = function activate() {\n    if (this._enabled && this._samplesStartTime == null) {\n      DEBUG && console.debug('FillRateHelper: activate');\n      this._samplesStartTime = global.performance.now();\n    }\n  };\n\n  _proto.deactivateAndFlush = function deactivateAndFlush() {\n    if (!this._enabled) {\n      return;\n    }\n\n    var start = this._samplesStartTime; // const for flow\n\n    if (start == null) {\n      DEBUG && console.debug('FillRateHelper: bail on deactivate with no start time');\n      return;\n    }\n\n    if (this._info.sample_count < _minSampleCount) {\n      // Don't bother with under-sampled events.\n      this._resetData();\n\n      return;\n    }\n\n    var total_time_spent = global.performance.now() - start;\n\n    var info = _objectSpread(_objectSpread({}, this._info), {}, {\n      total_time_spent: total_time_spent\n    });\n\n    if (DEBUG) {\n      var derived = {\n        avg_blankness: this._info.pixels_blank / this._info.pixels_sampled,\n        avg_speed: this._info.pixels_scrolled / (total_time_spent / 1000),\n        avg_speed_when_any_blank: this._info.any_blank_speed_sum / this._info.any_blank_count,\n        any_blank_per_min: this._info.any_blank_count / (total_time_spent / 1000 / 60),\n        any_blank_time_frac: this._info.any_blank_ms / total_time_spent,\n        mostly_blank_per_min: this._info.mostly_blank_count / (total_time_spent / 1000 / 60),\n        mostly_blank_time_frac: this._info.mostly_blank_ms / total_time_spent\n      };\n\n      for (var key in derived) {\n        derived[key] = Math.round(1000 * derived[key]) / 1000;\n      }\n\n      console.debug('FillRateHelper deactivateAndFlush: ', {\n        derived: derived,\n        info: info\n      });\n    }\n\n    _listeners.forEach(function (listener) {\n      return listener(info);\n    });\n\n    this._resetData();\n  };\n\n  _proto.computeBlankness = function computeBlankness(props, state, scrollMetrics) {\n    if (!this._enabled || props.getItemCount(props.data) === 0 || this._samplesStartTime == null) {\n      return 0;\n    }\n\n    var dOffset = scrollMetrics.dOffset,\n        offset = scrollMetrics.offset,\n        velocity = scrollMetrics.velocity,\n        visibleLength = scrollMetrics.visibleLength; // Denominator metrics that we track for all events - most of the time there is no blankness and\n    // we want to capture that.\n\n    this._info.sample_count++;\n    this._info.pixels_sampled += Math.round(visibleLength);\n    this._info.pixels_scrolled += Math.round(Math.abs(dOffset));\n    var scrollSpeed = Math.round(Math.abs(velocity) * 1000); // px / sec\n    // Whether blank now or not, record the elapsed time blank if we were blank last time.\n\n    var now = global.performance.now();\n\n    if (this._anyBlankStartTime != null) {\n      this._info.any_blank_ms += now - this._anyBlankStartTime;\n    }\n\n    this._anyBlankStartTime = null;\n\n    if (this._mostlyBlankStartTime != null) {\n      this._info.mostly_blank_ms += now - this._mostlyBlankStartTime;\n    }\n\n    this._mostlyBlankStartTime = null;\n    var blankTop = 0;\n    var first = state.first;\n\n    var firstFrame = this._getFrameMetrics(first);\n\n    while (first <= state.last && (!firstFrame || !firstFrame.inLayout)) {\n      firstFrame = this._getFrameMetrics(first);\n      first++;\n    } // Only count blankTop if we aren't rendering the first item, otherwise we will count the header\n    // as blank.\n\n\n    if (firstFrame && first > 0) {\n      blankTop = Math.min(visibleLength, Math.max(0, firstFrame.offset - offset));\n    }\n\n    var blankBottom = 0;\n    var last = state.last;\n\n    var lastFrame = this._getFrameMetrics(last);\n\n    while (last >= state.first && (!lastFrame || !lastFrame.inLayout)) {\n      lastFrame = this._getFrameMetrics(last);\n      last--;\n    } // Only count blankBottom if we aren't rendering the last item, otherwise we will count the\n    // footer as blank.\n\n\n    if (lastFrame && last < props.getItemCount(props.data) - 1) {\n      var bottomEdge = lastFrame.offset + lastFrame.length;\n      blankBottom = Math.min(visibleLength, Math.max(0, offset + visibleLength - bottomEdge));\n    }\n\n    var pixels_blank = Math.round(blankTop + blankBottom);\n    var blankness = pixels_blank / visibleLength;\n\n    if (blankness > 0) {\n      this._anyBlankStartTime = now;\n      this._info.any_blank_speed_sum += scrollSpeed;\n      this._info.any_blank_count++;\n      this._info.pixels_blank += pixels_blank;\n\n      if (blankness > 0.5) {\n        this._mostlyBlankStartTime = now;\n        this._info.mostly_blank_count++;\n      }\n    } else if (scrollSpeed < 0.01 || Math.abs(dOffset) < 1) {\n      this.deactivateAndFlush();\n    }\n\n    return blankness;\n  };\n\n  _proto.enabled = function enabled() {\n    return this._enabled;\n  };\n\n  _proto._resetData = function _resetData() {\n    this._anyBlankStartTime = null;\n    this._info = new Info();\n    this._mostlyBlankStartTime = null;\n    this._samplesStartTime = null;\n  };\n\n  return FillRateHelper;\n}();\n\nexport default FillRateHelper;"]},"metadata":{},"sourceType":"module"}